# litext (Lite Text)

## 项目介绍

正如项目名称所强调的，本程序旨在提供一个轻量灵活的纯文本编辑体验。

轻量化主要体现在如下几个方面：

* 部署：不使用平台级的技术，诸如 Java 或 .NET，所有运行时的逻辑都直接位于操作系统之上，没有中间层。
* 内存：对于特定的程序配置来说，单个文件使用的内存上限是固定的，也是可配置的，总的内存占用只取决于操作的文件的数量。例如，即便打开了一个 10GB 的文件，实际上也只会使用几十或上百 MB 的内存（这取决于配置）。
* 手感：不会在 GUI 线程中执行长时间的逻辑，GUI 线程只用来处理不得不由 GUI 线程处理的事情。做为 GUI 程序，保持响应是很重要的。
* 功能：如果某个功能已经由其它的程序很好得提供了，我就不会再提供了，例如我不会让程序尝试理解各种编程语言。我会把大部分的精力放在例如如何更充分地挖掘计算机性能，以便让文件打开地更快，或者如何让文本渲染更快。

基于 “使用超大文本文件的人大概也在使用不错的 CPU“ 这一假设，这个程序在首次加载某个文件时会尽可能多地使用 CPU 资源（仅仅是 CPU），这一过程很快。毕竟对于高性能的个人计算机而言，CPU 要比内存闲得多。而在其它时候，对 CPU 的使用也是非常谨慎的。

而如果重复打开某个还未被修改的文件，就不会像首次打开时使用尽可能多的 CPU 资源了。这是因为程序会为每个文件维护一个 KB 级别的很小的数据库。只有在首次打开时或者文件被修改后才需要重新创建这一数据库。所以，如果重复打开某个超大的文本文件，只需要一瞬间即可打开，以至于会让人忘记正在打开一个超大的文件。

* 注：目前的版本还没有实现加载已经创建的数据库的逻辑，每次都是当成首次打开，这是因为这个逻辑太简单了，我优先实现那些可能对整体规划有影响的功能。如果您发现我的程序在重复打开某个文件时变得很快，那估计是因为我忘了改 README。

此外，程序还是跨平台的，做为一个买不起 Apple 设备的程序员，我在开发过程中全程都同时在 Windows 和 Ubuntu 两个平台进行构建和操作。虽然我只用了两个平台，但核心的逻辑是和平台无关的，没有使用类似于 Windows GDI 之类的依赖于平台的组件。在我的经济状况好转后，我可以很轻易地将它在更多的平台上构建和操作。

## 技术特点

使用现代化的编码方式，C++语言版本使用C++17，辅助库以boost为主，使用新特性、新思想简化开发。

跨平台，开发中全程都同时在 Windows 10 和 Ubuntu 做构建和执行（虽然我很想用 “测试” 这个词，但现在还没有一套自动化的测试方式）。

## 对 Qt 的使用情况

**用了Qt，但随时可以换掉。**

尤其是**没有**使用诸如 QTextEdit 之类的组件，毕竟这些功能正是我要实现的关键。

首先用一句话概括对第三方库各种库的使用思路：**用组件，不用框架。**

的确，现阶段确实使用了很多 Qt 中的功能，但是，这仅仅是因为 Qt 中几乎有 GUI 程序所需的绝大多数组件，它门可以加速开发。

如果我要开发的是一个简单的对性能要求不高的程序，我会毫不犹豫地选择 Qt。但是在一个没有准确的完整预期的长期项目中，我不会选择 Qt 之类的开箱即用的库。这是因为，这些库会对开发者的思路做出限制，例如 Qt 中的信号系统，或者线程间的通信方式，等等。这些东西很诱人，它门足够便利，也能够在大多数时候提供不错的性能。但是如果严重地依赖它门，会在未来的某一天突然发现自己想要实现的某个新功能无法和这套东西兼容，实际上我在开发的过程中已经遇到了这种情况，例如 QFont 及其系列模块在多线程环境中的糟糕表现。

具体来说，目前我**用到**了 Qt 中的这些东西：

* 字符集转换：字符集转换虽然是本程序最关键的逻辑之一，但它足够独立。
  * 未来，直接把字符集的映射关系以源代码的形式直接内置到项目中，并且直接针对本项目设计逻辑和数据结构，以达到更高的性能。
* 边缘 GUI 组件：例如窗口、菜单、工具栏、滚动条等随处可见的基础 GUI 组件，它门可以在任何 GUI 工具包中被找到。
  * 未来，用更加轻量的控件替换 Qt 提供的控件，例如直接用 Windows 提供的原生控件，这能有效地提升启动速度。
* 2D 绘图：只用于绘制简单的图元和位图，而字符的绘制是直接绘制由 FreeType 获得位图（Qt 的字符绘制有各种问题，无法满足我的目标）。
  * 未来，用更适合我的项目的 2D 绘图库替代 Qt 的绘图。这部分我大概不会自己实现，使用成熟的库可以确保绘图在任何平台上都有很好的效率。我调查了现有的主流的 2D 绘图库，要么太重量级，要么不能轻松地支持跨平台开发。
* 其它暂时没想起来的。


## 构建完成的包

TODO

## 开发环境搭建

TODO

